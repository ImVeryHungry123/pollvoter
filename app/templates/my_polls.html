{% extends "base.html" %}

{% block title %}My Polls - Polling{% endblock %}

{% block content %}
<div class="polls-header">
    <h2>My Polls</h2>
    <a href="{{ url_for('polls.create_poll') }}" class="btn btn-primary">Create Poll</a>
</div>

{% if polls.items %}
    {% for poll in polls.items %}
    <div class="poll-card">
        <div class="poll-header">
            <h3><a href="{{ url_for('polls.poll_detail', poll_id=poll.id) }}">{{ poll.title }}</a></h3>
            <span class="poll-stats">
                <i class="fas fa-vote-yea"></i> {{ poll.getvotecount() }} votes
                <i class="fas fa-comments"></i> {{ poll.comments|length }} comments
            </span>
        </div>
        
        <div class="poll-meta">
            <small class="poll-date">Created: {{ poll.created_at.strftime('%d.%m.%Y at %H:%M') }}</small>
        </div>
        
        {% if poll.description %}
        <p class="poll-description">{{ poll.description }}</p>
        {% endif %}
        

        
        <div class="poll-actions">
            <a href="{{ url_for('polls.poll_detail', poll_id=poll.id) }}" class="btn btn-primary">View</a>
            <a href="{{ url_for('polls.edit_poll', poll_id=poll.id) }}" class="btn btn-primary">Edit</a>
            <form action="{{url_for('polls.delete_poll', poll_id = poll.id)}}" method="POST">
                <button type="submit" onclick="return confirm('Do you want to delete this poll?')">Delete</button>
            </form>
        </div>
    </div>
    {% endfor %}

    <!-- Pagination -->
    <div class="pagination">
        {% if polls.has_prev %}
            <a href="{{ url_for('polls.my_polls', page=polls.prev_num) }}" class="page-link">← Previous</a>
        {% endif %}
        
        <span class="page-info">Page {{ polls.page }} of {{ polls.pages }}</span>
        
        {% if polls.has_next %}
            <a href="{{ url_for('polls.my_polls', page=polls.next_num) }}" class="page-link">Next →</a>
        {% endif %}
    </div>
{% else %}
    <div class="no-polls">
        <p>You haven't created any polls yet. <a href="{{ url_for('polls.create_poll') }}">Create the first one!</a></p>
    </div>
{% endif %}
{% endblock %}
