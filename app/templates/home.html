{% extends 'base.html' %}
{% block title %}Home{% endblock %}

{% block content %}













<div class="dashboard-layout">
    
    <aside class="sidebar">
        <div class="sidebar-widget">
            <h3 class="widget-title">âœ¨ Create a Poll</h3>
            <form action="{{ url_for('polls.create_poll') }}" method="GET">
                <div style="margin-bottom: 15px;">
                    <input type="text" placeholder="What's your question?" readonly style="cursor: pointer;">
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">Create Poll</button>
            </form>
        </div>

<div class="sidebar-widget">
    <h3 class="widget-title">People to Follow</h3>
    
    {% if suggestions %}
        {% for user in suggestions %}
        <div class="user-row">
            <img src="{{ user.getpfp() }}" alt="{{ user.username }}" class="avatar-sm">
            
            <div style="flex-grow: 1; margin-left: 10px;">
                <a href="{{ url_for('main.profile', username=user.username) }}" style="font-weight: bold; font-size: 0.9rem; display: block;">
                    {{ user.username }}
                </a>
                <div style="font-size: 0.8rem; color: var(--text-muted);">
                    @{{ user.username|lower }}
                </div>
            </div>
            
            <a href="{{ url_for('main.follow', username=user.username) }}" class="btn btn-sm btn-outline" style="padding: 4px 10px; font-size: 0.8rem;">
                Follow
            </a>
        </div>
        {% endfor %}
    {% else %}
        <p style="color: var(--text-muted); font-size: 0.9rem;">No new users to follow.</p>
    {% endif %}
</div>
    </aside>

    <main class="feed">
        {% if current_user.is_authenticated %}
            <div style="margin-bottom: 20px;">
                <h2>Recent Polls</h2>
            </div>

            {% if polls %}
                {% for poll in polls %}
                <div class="poll-card">
                    <div class="user-row" style="border:none; margin-bottom: 10px;">
                        <div class="avatar-sm" style="background-color: #333; color: white; display: flex; align-items: center; justify-content: center; font-size: 0.9rem;">
                            {{ poll.author.username[0]|upper }}
                        </div>
                        <div>
                            <div style="font-weight: bold;">{{ poll.author.username }}</div>
                            <div style="font-size: 0.8rem; color: var(--text-muted);">{{ poll.created_at.strftime('%b %d') }}</div>
                        </div>
                    </div>

                    <h3><a href="{{ url_for('polls.poll_detail', poll_id=poll.id) }}" style="text-decoration: none;">{{ poll.title }}</a></h3>
                    
                    {% if poll.description %}
                        <p>{{ poll.description }}</p>
                    {% endif %}

                    <div class="poll-options-list">
                        <a href="{{ url_for('polls.poll_detail', poll_id=poll.id) }}" class="poll-option-btn">View Options & Vote</a>
                    </div>

                    <div class="poll-meta-footer">
                        <span>ðŸ“Š {{ poll.getvotecount() }} votes</span>
                        <span>ðŸ’¬ {{ poll.comments|length }} comments</span>
                    </div>
                </div>
                {% endfor %}
            {% else %}
                <div class="poll-card" style="text-align: center; padding: 3rem;">
                    <p>No polls found.</p>
                    <a href="{{ url_for('polls.create_poll') }}" class="btn btn-primary">Create the first one!</a>
                </div>
            {% endif %}

        {% else %}
            <div class="card" style="text-align: center; padding: 4rem 2rem;">
                <h1>Welcome to Pollvoter!</h1>
                <p>Join the community to create polls and vote on trending topics.</p>
                <div style="margin-top: 2rem;">
                    <a href="{{ url_for('auth.login') }}" class="btn btn-outline">Login</a>
                    <a href="{{ url_for('auth.register') }}" class="btn btn-primary">Register</a>
                </div>
            </div>
        {% endif %}
    </main>
</div>
{% endblock %}