{%extends 'base.html'%}
{%block title%}Main Page{%endblock%}

{%block content%}
<div>
    <h1>Welcome to our page!</h1>
    <p>Pollvoter is a site where you can create polls and make some friends with the same opinion!</p>

    {%if not current_user.is_uthenticated%}
    <div>
        <a href="{{url_for('auth.login')}}">Login</a>
        <a href="{{url_for('auth.register')}}">Register</a>
    </div>
    {%endif%}
</div>

{%if current_user.is_uthenticated%}
<div>
    <h2>Recent polls</h2>
    {%if polls%}
    {%for poll in polls%}
    <div>
        <div>
            <h3><a href="{{url_for('polls.poll_detail',poll_id = poll.id)}}">{{poll.title}}</a></h3>
            <span>
                <i>{{poll.getvotecount()}} Votes
                <i>{{poll.comments|length}} Comments</i>
                </i>
            </span>
        </div>

        <div>
            <div>{{poll.author.username[0]|upper}}</div>
            <div>
                <div>{{poll.author.username}}</div>
                <small>{{poll.created_at.strftime('%d.%m.%Y %H:%M')}}</small>
            </div>
        </div>

    {% if poll_description%}
    <p>{{poll.description}}</p>
    {%endif%}

    <div>
        <a href="{{url_for('polls.poll_detail',poll_id = poll.id)}}">Show details</a>
    </div>
    </div>
    {%endfor%}
    {%else%}

    <div>
        <p>No polls <a href = "{{url_for('polls.create_poll')}}">Create first poll!!!</a></p>
    </div>
    {%endif%}

</div>
{%endif%}

{%endblock%}